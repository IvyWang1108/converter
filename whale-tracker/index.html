<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antarctic Humpback Whale Tracker</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a5276">
</head>
<body>
    <div class="container">
        <header>
            <h1>Antarctic Humpback Whale Tracker</h1>
            <p>Live sightings of humpback whales in the Antarctic region</p>
        </header>
        
        <div id="map"></div>
        
        <div class="info-panel">
            <h3>Recent Sightings</h3>
            <div id="sightings-list">
                <div class="loading">Loading whale sightings...</div>
            </div>
        </div>
        
        <footer>
            <p>Data provided by <a href="https://www.gbif.org/" target="_blank">GBIF</a> â€¢ 
            <a href="#" id="install-btn" style="display:none;">Install App</a></p>
        </footer>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="app.js"></script>
    <script>
        // PWA installation
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }

        // Handle install button
        let deferredPrompt;
        const installBtn = document.getElementById('install-btn');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'block';
            
            installBtn.addEventListener('click', () => {
                installBtn.style.display = 'none';
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted install');
                    } else {
                        console.log('User declined install');
                    }
                    deferredPrompt = null;
                });
            });
        });
    </script>
</body>
</html>
